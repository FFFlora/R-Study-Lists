Octave solutions provided by danielfmt.