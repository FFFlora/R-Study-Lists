C# solution provided by stochastictinker .