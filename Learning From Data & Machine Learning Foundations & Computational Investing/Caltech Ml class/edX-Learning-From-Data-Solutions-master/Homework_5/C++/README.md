C++ solution provided by Victoras.